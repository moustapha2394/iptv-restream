services:
  backend:
    # Option 1: Build local (développement)
    # build: ./backend
    
    # Option 2: Pull depuis GitHub Container Registry (production)
    image: ghcr.io/moustapha2394/iptv-restream/backend:main
    
    container_name: iptv_backend
    ports:
      - "8002:8002"
    environment:
      # ========== XTREAM CODES API - CONFIGURATION OBLIGATOIRE ==========
      # URL de votre serveur Xtream (exemple: http://votre-serveur.com:8080)
      - XTREAM_API_URL=http://your-xtream-server.com:port
      
      # Nom d'utilisateur Xtream (obtenu depuis votre fournisseur IPTV)
      - XTREAM_USERNAME=your_xtream_username
      
      # Mot de passe Xtream (obtenu depuis votre fournisseur IPTV)
      - XTREAM_PASSWORD=your_xtream_password
      
      # ========== SÉCURITÉ JWT - À MODIFIER EN PRODUCTION ==========
      # Clé secrète JWT - Générer avec: openssl rand -hex 32
      - JWT_SECRET_KEY=CHANGE_ME_generate_with_openssl_rand_hex_32
      
      # Admin Password Hash - Par défaut: admin123
      # Pour changer: python -c "from passlib.context import CryptContext; pwd_context = CryptContext(schemes=['bcrypt'], deprecated='auto'); print(pwd_context.hash('VotreNouveauMotDePasse'))"
      - ADMIN_PASSWORD_HASH=$$2b$$12$$Swx6tdNWLUJ8Q9yec8TnceVbeCrp7JP.bpbhZSXjagS8zt1Bhupyi
    restart: unless-stopped
    networks:
      - iptv_network

  frontend:
    # Option 1: Build local (développement)
    # build: ./frontend
    
    # Option 2: Pull depuis GitHub Container Registry (production)
    image: ghcr.io/moustapha2394/iptv-restream/frontend:main
    
    container_name: iptv_frontend
    ports:
      - "8001:8001"
    environment:
      - BACKEND_URL=http://backend:8002
    depends_on:
      - backend
    restart: unless-stopped
    networks:
      - iptv_network

networks:
  iptv_network:
    driver: bridge
